function initShaderProgram(t,r,a){const i=loadShader(t,t.VERTEX_SHADER,r),o=loadShader(t,t.FRAGMENT_SHADER,a),e=t.createProgram();return t.attachShader(e,i),t.attachShader(e,o),t.linkProgram(e),t.getProgramParameter(e,t.LINK_STATUS)?e:null}function loadShader(t,r,a){const i=t.createShader(r);return t.shaderSource(i,a),t.compileShader(i),t.getShaderParameter(i,t.COMPILE_STATUS)?i:(alert(t.getShaderInfoLog(i)),t.deleteShader(i),null)}import{initBuffers}from"./init-buffers.js";import{drawScene}from"./draw-scene.js";import"https://cdnjs.cloudflare.com/ajax/libs/gl-matrix/2.8.1/gl-matrix-min.js";class background3D{#t=0;#r=mat4.create();#a=mat4.create();#i=mat4.create();#o=vec3.fromValues(.01*(Math.random()-.5),.01*(Math.random()-.5),.01*(Math.random()-.5));#e=0;#n=0;canvas=null;color=null;#s=0;#c=0;setTheme=()=>{};constructor(t,r,a,i){this.canvas=a,i||(i=a),i.background3DObject=this,this.canvas.style.opacity=r[3],this.canvas.width=this.canvas.clientWidth,this.canvas.height=this.canvas.clientHeight,this.color=r,document.addEventListener("mousemove",(t=>{this.#e=t.clientX,this.#n=t.clientY;let r=document.body.clientWidth,a=document.body.clientHeight;this.#e=(this.#e-r/2)/(r/2),this.#n=(this.#n-a/2)/(a/2)})),this.#c=this.canvas.getContext("webgl");const o=this.#c;if(null===o)return;o.clearColor(0,0,0,0),o.clear(o.COLOR_BUFFER_BIT);const e=initShaderProgram(o,"\n      attribute vec4 aVertexPosition;\n      attribute vec3 aBaricentricCoord;\n\n      uniform mat4 uModelViewMatrix;\n      uniform mat4 uProjectionMatrix;\n\n      varying lowp vec3 vBaricentricCoord;\n\n      void main(void) {\n        gl_Position = uProjectionMatrix * uModelViewMatrix * aVertexPosition;\n        vBaricentricCoord = aBaricentricCoord;\n      }\n    ","\n      varying lowp vec3 vBaricentricCoord;\n      uniform lowp vec4 uWireframeColor;\n\n      void main(void) {\n        gl_FragColor = float((vBaricentricCoord[0] < 0.01) || (vBaricentricCoord[1] < 0.01) || (vBaricentricCoord[2] < 0.01))*uWireframeColor;\n      }\n    "),n={program:e,attribLocations:{vertexPosition:o.getAttribLocation(e,"aVertexPosition"),baricentricPosition:o.getAttribLocation(e,"aBaricentricCoord")},uniformLocations:{projectionMatrix:o.getUniformLocation(e,"uProjectionMatrix"),modelViewMatrix:o.getUniformLocation(e,"uModelViewMatrix"),wireframeColor:o.getUniformLocation(e,"uWireframeColor")}},s=initBuffers(o,t);this.#s=0,requestAnimationFrame((t=>this.#h(t,n,s)))}#h(t,r,a){t*=.001,this.#t=t-this.#s,this.#s=t,mat4.rotateY(this.#r,this.#r,this.#t*this.#e/2),vec3.rotateX(this.#o,this.#o,vec3.fromValues(0,0,0),this.#t*(Math.random()-.5)),vec3.rotateY(this.#o,this.#o,vec3.fromValues(0,0,0),this.#t*(Math.random()-.5)),vec3.rotateZ(this.#o,this.#o,vec3.fromValues(0,0,0),this.#t*(Math.random()-.5)),mat4.translate(this.#a,this.#a,this.#o),mat4.multiply(this.#i,this.#a,this.#r),Math.random()>.99&&(this.#o=vec3.fromValues(.01*(Math.random()-.5),.01*(Math.random()-.5),.01*(Math.random()-.5))),drawScene(this.#c,r,a,this.#i,this.color),requestAnimationFrame((t=>this.#h(t,r,a)))}}export{background3D};